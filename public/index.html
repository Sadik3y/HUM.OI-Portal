<!-- index.html â€” Fixed for Browser Safety -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>HUM.OI Portal</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet" href="reflection.css" />
</head>
<body class="theme-calm">

  <!-- Ambient Music Toggle -->
  <button id="music-toggle">ðŸŽµ Play Music</button>

  <!-- Panels -->
  <div id="reflection" class="panel">
    <h3>Reflection</h3>
    <div id="chat-box"></div>
    <input type="text" id="user-input" placeholder="Speak your truth..." />
    <button id="send-btn">Send</button>
  </div>

  <div id="memories" class="panel">
    <h3>Shared Memories</h3>
    <div id="memory-list"></div>
  </div>

  <div id="soul-journal" class="panel">
    <h3>ðŸ“œ Soul Journal</h3>
    <div id="soul-journal-entries"></div>
  </div>

  <div id="rituals" class="panel">
    <h3>ðŸ”® Rituals</h3>
    <button onclick="blessThisSpace()">âœ¨ Bless This Space</button>
    <button onclick="summonReflection()">ðŸªž Summon Reflection</button>
    <button onclick="speakToTheStars()">ðŸŒŒ Speak to the Stars</button>
  </div>

  <!-- âœ… Load only browser-safe modules -->
  <script type="module" src="script.js"></script>
  <script src="hum-orb.js"></script>
  <script src="starfield.js"></script>

  <!-- Optional: Meditation & Rituals Logic (browser-safe) -->
  <script>
    let idleTimer;
    let meditationActive = false;

    function enterMeditationMode() {
      if (meditationActive) return;
      meditationActive = true;
      document.body.style.transition = "background 4s ease";
      document.body.style.filter = "brightness(0.85) saturate(0.9)";
      document.body.style.animationDuration = "40s";
    }

    function resetIdleTimer() {
      clearTimeout(idleTimer);
      document.body.style.filter = "";
      document.body.style.animationDuration = "";
      meditationActive = false;
      idleTimer = setTimeout(enterMeditationMode, 180000);
    }

    ['click', 'mousemove', 'keypress'].forEach(event => {
      window.addEventListener(event, resetIdleTimer);
    });

    window.addEventListener('load', () => {
      resetIdleTimer();
      if (typeof initHUMOrb === 'function') initHUMOrb();
      applySeasonalTheme?.();
    });

    function blessThisSpace() {
      document.body.className = 'theme-calm';
      document.body.style.filter = "";
      document.body.style.animationDuration = "20s";
      return "âœ¨ This space has been gently blessed.";
    }

    function summonReflection() {
      alert("Reflection summoned. (Backend handles real logic)");
    }

    function speakToTheStars() {
      alert("The stars are listening. (Backend handles real message)");
    }
  </script>

</body>
</html>
